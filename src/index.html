<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workflow Form - PowerAutomate Integration</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>📋 書類作成フォーム</h1>
            <p>PowerAutomate連携型の書類作成フォーム</p>
        </div>

        <div class="content">
            <!-- タブナビゲーション -->
            <div class="nav-tabs">
                <button class="nav-tab active" onclick="switchTab('form', this)">📝 フォーム</button>
                <button class="nav-tab" onclick="switchTab('settings', this)">⚙️ 設定</button>
            </div>

            <!-- フォームタブ -->
            <div id="form-tab" class="tab-content active">
                <!-- Step 1: 書類選択 -->
                <div class="section">
                    <h2 class="section-title">ステップ1: 作成する書類を選択</h2>
                    <div class="info-message">
                        必要な書類をチェックボックスで選択してください（複数選択可能）
                    </div>
                    <div class="document-list" id="documentList">
                        <!-- 動的に生成されます -->
                    </div>
                </div>

                <!-- Step 2: 共通情報入力 -->
                <div class="section">
                    <h2 class="section-title">ステップ2: 共通情報を入力（すべての書類で使用）</h2>
                    <div class="info-message">
                        💡 この情報は、選択したすべての書類で自動的に使用されます。一度だけ入力すればOKです。
                    </div>
                    <div id="common-form">
                        <!-- 動的に生成されます -->
                    </div>
                </div>

                <!-- Step 3: 各書類固有の情報入力 -->
                <div class="section">
                    <h2 class="section-title">ステップ3: 各書類固有の情報を入力</h2>
                    <div class="info-message">
                        選択した書類ごとに、その書類に特有の情報を入力してください。入力後、「PowerAutomateに送信」ボタンをクリックすると、データがPowerAutomateに送信されます。
                    </div>
                    <div id="document-forms">
                        <!-- 動的に生成されます -->
                    </div>
                </div>

                <!-- Submit Button -->
                <button class="submit-btn" id="submitBtn" onclick="sendToWebhook()">
                    PowerAutomateに送信
                </button>

                <!-- Step 4: 結果表示 -->
                <div class="result-section" id="resultSection">
                    <h3>送信結果</h3>
                    <div class="result-content" id="resultContent"></div>
                </div>
            </div>

            <!-- 設定タブ -->
            <div id="settings-tab" class="tab-content">
                <div class="section">
                    <h2 class="section-title">⚙️ Webhook設定</h2>
                    <div class="info-message">
                        PowerAutomateのHTTP要求トリガーのURLと認証トークンを設定してください。
                    </div>
                    <div class="form-group">
                        <label for="webhook-url">Webhook URL</label>
                        <input type="text" id="webhook-url" placeholder="https://prod-xxx.webhook.office.com/webhookb2/..." value="">
                    </div>
                    <div class="form-group">
                        <label for="webhook-token">認証トークン</label>
                        <input type="text" id="webhook-token" placeholder="your-secret-token" value="">
                    </div>
                    <button class="btn btn-primary" onclick="saveWebhookSettings()">保存</button>
                </div>

                <div class="section">
                    <h2 class="section-title">📄 書類タイプ設定</h2>
                    <div class="info-message">
                        作成する書類の種類と入力フィールドを設定できます。
                    </div>
                    <div id="document-types-container">
                        <!-- 動的に生成されます -->
                    </div>
                    <button class="btn btn-primary" onclick="addDocumentType()" style="margin-top: 15px;">書類タイプを追加</button>
                    <button class="btn btn-primary" onclick="saveDocumentTypes()" style="margin-top: 15px; margin-left: 10px;">書類タイプを保存</button>
                </div>

                <div id="alertContainer"></div>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
